<?xml version="1.0" encoding="UTF-8"?>
<Module>
    <ModulePrefs title="Fuck">
        <Require feature="wave"/> 
        <Require feature="dynamic-height"/>
    </ModulePrefs>
	<Content type="html">
        <![CDATA[ 
        <div id="content_div" style="height: 50px;"></div>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
        <script type='text/javascript'>
            (function () {
                
                function _get(){
                  return eval("(" + wave.getState().get('fuckmehard', '{}') + ")");
                }
                function _set(){
                    wave.getState().submitDelta({'fuckmehard': "{current: Date()}"});
                }
                
                function getGadgetState(){
                    return wave.getState().get('fuck', '0');
                }
                
                function getStateInt(){                    
                    return parseInt(getGadgetState());
                }
                
                function updateDom(){
                    $("#content_div").html(getStateInt());    
                    alert(wave.getState().toString());                                    
                }  

                function init() {
                    if (!wave && !wave.isInWaveContainer()) { return; }
                    
                    $(document).ready(function() {
                        wave.setStateCallback(updateDom);
                    });
                    
                    $("#fuck").click(function(){
                        _set();
                        wave.getState().submitDelta({'fuck': getStateInt()+1});
                    });
                }

                gadgets.util.registerOnLoadHandler(init);

            })();
        </script>
        <input id="fuck" type="button" value="+" />
        ]]>
    </Content>
</Module>